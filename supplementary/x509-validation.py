from OpenSSL.crypto import load_certificate, load_privatekey, FILETYPE_PEM
from OpenSSL.crypto import X509Store, X509StoreContext
from six import u, b, binary_type, PY3

root_cert_pem = b("""-----BEGIN CERTIFICATE-----
MIIFYzCCA0ugAwIBAgIUOu2OXzrh777KiRWK4pVS8/Zr2jswDQYJKoZIhvcNAQEL
BQAwQTELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAk5ZMQ0wCwYDVQQHDARCS0xOMRYw
FAYDVQQKDA1Sb290IENBIENlcnQgMB4XDTIxMTEwMzAzMTIzOVoXDTMxMTEwMTAz
MTIzOVowQTELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAk5ZMQ0wCwYDVQQHDARCS0xO
MRYwFAYDVQQKDA1Sb290IENBIENlcnQgMIICIjANBgkqhkiG9w0BAQEFAAOCAg8A
MIICCgKCAgEApmziIem4AEyE3kLW46f+XbU1SAFn8lEWp6KyvSsQ2P2cQbVFCu4W
27ViIqZnn8FdYVlNEvwK+XE5YTmRpI5P/nA2jxYm5/HyGCzUSobu0YTPSskdgsZm
zkPZ0hoZyC3DCL5FPPy9IBaGHdxsq6J3LQ1x+TCRLLcK+JOIo0cEIxiA0Wc2/Jvc
0Nvs+fyMZtlmfub2QocGvRputzE++jkWI4aHIB29kuu6FaeivZiN30FUPDRzIGG9
psm6JYgUiemhaSJQdHr9qsVzctP+v+PdNYSJbGFDhb6rpz9UyMWRmWzlKymjDDV7
pEtcBp7CyPDNxtewh7UuOVb2GjfhqTePTfsGcfZnyv7jaEErHTkP4c5kJsBCJq+w
7Ui2IiUe816bn7GpWmpr3rb0GSHpDRvxjKZw5aULDN3JlGDYbdajFg08Fe/ehG7N
t+Xq+TANU77GFeQYcZrigPAXV4xMFCUCEzl18UghVnQGyslB5SJpPd4ULsMz7kxZ
bckOloBWEt9c9OlYR7XXjiozPD2oMpvilicM24fr1w9WHBv20fJwOH5jcYQ3Mmsq
WoAyZ0LMQ+kdt48vLPWV9Mp1h//1mmYuLWXKNtNcMeLMzslh4d4tZVQbhZX4FIaj
Vgyz+3jR2eukUFpFQp8BxKMYkonAeyTm6hDWeiL91uZ6ObH3B8JFVfkCAwEAAaNT
MFEwHQYDVR0OBBYEFD0inUn+0gm7y1xx+oFK+6VLV2y4MB8GA1UdIwQYMBaAFD0i
nUn+0gm7y1xx+oFK+6VLV2y4MA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQEL
BQADggIBAHXQs7u+4ksyNngw2yY66Kmkv/684Cna5x2wyer0tqHMuX1gBA+zxiRP
sybuQWngplV1Z2Q6yN2CW+KEAVE/HTm3LYHcrBMumZoTvgikZjTMBQ/OVwzXfv9q
Cip6O2OHDQA/jgXIUWs7d68GL7BKIIesNcfjbWNu94G6DwckJX5dMPaIuYamyIeo
/uZgkjH1iTF+HzADZpbyNXBkiM8DlMAVJ/bzutPCPeABVsCWlAlWh1UCqh23gM0d
mzKGjE9XK732SllM2VGK3AtecJWQG4d57U4mzBubd+/n8IcFQnafxE/hbtJIrABG
sE4RNZdoroQ4YrIx0Lmwfjif+th16paixfLCHhKvha2zYQYtOWoBdyRmImcyfGKX
KWgQaNwm6XPFnsvsSpNR7LHIXPKU342zWnrH41Es028GiEYbtPyPkFIm2hbvK43p
rorzGPtTkOfhcxno9HysxssNBFrs6JWKI0R7N6uLACvp4zq85UbP5hgTBblldTyw
GFB04YqJw/Z+jt7yrBoF47U4TF+GPpDBRPD/rPDOOwzZi7P1jG9ciCYzqpyDwlWJ
2vOvdl7VK5+m+KPjh5QMXsnbozqGtknz32exfVhWJ2oot2DAIYLsyVk9uKysefcZ
ou1JeLA4Aivuh2hva/UKa2p5XEq5kTh7JW6gKmtbbKTk3HrpI6JT
-----END CERTIFICATE-----
""")

untrusted_cert_pem = b("""-----BEGIN CERTIFICATE-----
MIIEYTCCAkmgAwIBAgIUVoW3aID6E5OqXqY+Jy+qSBnmghkwDQYJKoZIhvcNAQEL
BQAwQTELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAk5ZMQ0wCwYDVQQHDARCS0xOMRYw
FAYDVQQKDA1Sb290IENBIENlcnQgMB4XDTIxMTEwMzAzNDYzMVoXDTMxMTEwMTAz
NDYzMVowPzELMAkGA1UEBhMCVVMxCzAJBgNVBAgMAk5ZMQ0wCwYDVQQHDARCS0xO
MRQwEgYDVQQKDAttVExTIGNsaWVudDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
AQoCggEBAJ/AqLNGZc9RygM5HrOAJJNiVA1PSMydacvGIMyeFb7RpvM+VNd8OPQU
IbKEIHUnvOQnzvKHazck4jnJf6YvOwMoYo5m1U9iaimD6T00nLa1kDbVozCFfKl4
WP3YxCM3ysd8tvIYl2YXHdG5h4XuvnnvjekaY1h+NYXBd3I3CiayEEilGkrEdt07
AG0mqRCsgaK6p/LA5EVmriJx+0C+v21kz3UqF8qcNMo9ZbgD4E+g/CYKyNCD090M
AfKD5hZWSQKjKvBsfibHbFjcVWehpOR77qZ0A+AI1onzkFz49gyYPFsqxJSPWTGQ
1wB6pmQAYkGbmKJNiQPlM1rBrIm2VtECAwEAAaNTMFEwHwYDVR0jBBgwFoAUPSKd
Sf7SCbvLXHH6gUr7pUtXbLgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBPAwFgYDVR0R
BA8wDYILbVRMUy5jbGllbnQwDQYJKoZIhvcNAQELBQADggIBACW2wgT7hyBlp/J/
HMpQaufNu6KNKAITh97XigML+DFlfWMMoiOOhDV0060h0h7Zl4t5SIOoomBbL0i1
LV4IimQMoAgvTiAvDp1ZE584UTGQn050CbvvQmAUrM0IB7Kq5MXjC6ikG4FCAtNZ
YEnd49p64On36tVdaGHHer+Fe/SJ5rMb/jPSH9+ae5/bReHxd4Rimx400QFMZfab
u3O69CWeg00JpBYXjsbelWVgdQ3E1SBC2IXkGNxAqRAk58JM0pN0jFJxFQ/LBXBK
pEIAy8DxrJ1nvkSO5YRF6KhPMqa65AEcaCz4Hwh6q2YuBznyYBW8VuXpu3wr2qhr
HDUFZEIySeSD/0SC5uVGLxfcGLQOoKJQ7LiX2QqUtWYUBFmKkJbZdBlXSjQTNuqw
NWE2o8ke1Cm0QF2QoA3cjTnYQptGVkRjhs96FxN3Tb0YCM53PrFhngSkQBKnjLRj
7JTIwTkU7E4h+dvadUuI+vzJdMSjLFETXIay244+94AxHtiEacghJfUtOoDgeECk
C2UEq4SFwJgY2zr7rGVe2bRCXVCB9GHBQ9AgaNqvNEVXE5cXnvwJQBNG79UG+jir
kk6P5cYXZTe5WU/k1PDHX3x9aYHEj9GfOja8f8iuSCYTSaw/7n388AmiVNLKpItT
U9570yApVAru1ed8zoRyOB3dkleb
-----END CERTIFICATE-----
""")


root_cert = load_certificate(FILETYPE_PEM, root_cert_pem)
untrusted_cert = load_certificate(FILETYPE_PEM, untrusted_cert_pem)

store = X509Store()
store.add_cert(root_cert)

store_ctx = X509StoreContext(store, untrusted_cert)
print(store_ctx.verify_certificate())
